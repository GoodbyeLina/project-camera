# ESP32-S3 串口通信与测试模式技术文档

## 1. 功能概述
本项目实现了ESP32-S3通过UART串口发送数据的两种模式：
- **测试模式**：发送0-255递增测试数据
- **摄像头模式**：发送OV7670摄像头捕获的图像数据

## 2. 代码结构

### 2.1 主程序 (main/main.c)
```c
#define TEST_MODE 1  // 1=测试模式 0=摄像头模式

#if TEST_MODE
// 测试模式代码
void send_test_data() {
    // 生成0-255测试数据
    // 发送数据帧(AA 55头+长度+数据)
}
#else 
// 摄像头模式代码
// 初始化摄像头
// 捕获并发送图像帧
#endif
```

### 2.2 接收程序 (tools/serial_receiver.py)
- 监听指定串口(默认COM8)
- 解析数据帧(AA 55头)
- 同时保存二进制(.bin)和可读文本(.txt)文件
- 详细的调试输出

## 3. 测试模式说明

### 3.1 数据格式
```
[AA][55][长度高位][长度低位][数据...]
```
- 测试数据：256字节(0x00-0xFF)
- 发送间隔：1秒/帧

### 3.2 验证方法
1. 检查接收到的.txt文件内容应为：
```
0000: 00 01 02 03 ... FF
```
2. 二进制文件应包含完整256字节

## 4. 使用指南

### 4.1 发送端(ESP32)
1. 设置模式：
   - 测试模式：`#define TEST_MODE 1`
   - 摄像头模式：`#define TEST_MODE 0`
2. 编译并烧录程序

### 4.2 接收端(PC)
```bash
python tools/serial_receiver.py
```
- 输出目录：`C:\Users\[用户名]\Desktop\esp_camera`
- 包含.bin和.txt文件

## 5. 版本历史
- v1.0 (2025-03-28): 初始版本
   - 实现基本测试模式
   - 增强接收程序调试功能